{% extends "base.html.jinja" %}

{% set type_icon = 'database' %}
{% set local_name = node.split('/') | last %}
{% set title = node | title_any(languages=['de'], default=local_name) %}

{% block breadcrumbs %}
  <div class="row breadcrumbs">
    <div class="col-12">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            {{ dataset_breadcrumb }}
          </li>
        </ol>
      </nav>
    </div>
  </div>
{% endblock breadcrumbs %}

{% block info_table_content %}
  {{ super }}

  {% set date_created = node | rdf_property_any(DCT.created) %}
  {% if date_created %}
    <tr>
      <td>zuerst erstellt am:</td>
      <td>{{ date_created }}</td>
    </tr>
  {% endif %}

  {% set date_modified = node | rdf_property_any(DCT.modified) %}
  {% if date_modified %}
    <tr>
      <td>zuerst geändert am:</td>
      <td>{{ date_modified }}</td>
    </tr>
  {% endif %}

  {% set publishers = node | rdf_property(DCT.publisher) %}
  {% for publisher in publishers %}
    <tr>
      <td>Veröffentlichende Stelle:</td>
      <td>
        <a href="{{ publisher }}">
          {% set publisher_local_name = helper.prefix_label(publisher) %}
          {{ publisher | title_any(['de', 'en'], publisher_local_name) }}
        </a>
      </td>
    </tr>
  {% endfor %}

  {% set homepage = node | rdf_property_any(FOAF.homepage) %}
  {% if homepage %}
    <tr>
      <td>Homepage:</td>
      <td>
        <a href="{{ homepage }}">
          {{ homepage }}
        </a>
      </td>
    </tr>
  {% endif %}

  {% set root_resource = node | rdf_property_any(VOID.rootResource) %}
  {% if root_resource %}
    <tr>
      <td>Einstiegsressource:</td>
      <td>{{ helper.prefix_link(root_resource) }}</td>
    </tr>
  {% endif %}


{% endblock info_table_content%}

              {# 
              {%  capture vocabs_query %}
                SELECT ?vocab
                WHERE {
                  ?resourceUri void:vocabulary ?vocab ;
                } ORDER BY ?vocab
              {% endcapture %}
              {% assign vocabs = page.rdf | sparql_query: vocabs_query %}
              {% if vocabs.size > 0 %}
                {% for row in vocabs %}
                  <tr>
                    <td>Genutztes Vokabular:</td>
                    <td>{% include core/prefix_url.html iri = row.vocab.iri %}</td>
                  </tr>
                {% endfor %}
              {% endif %}

              {% assign versions = page.rdf | rdf_property: "dct:hasVersion", nil, true %}
              {% for version in versions %}
                <tr>
                  <td>Andere Version:</td>
                  <td>{% include core/prefix_url.html iri = version.iri %}</td>
                </tr>
              {% endfor %}
              {% assign data_dumps = page.rdf | rdf_property: "void:dataDump", nil, true %}
              {% for data_dump in data_dumps %}
                <tr>
                  <td>Datensatz-Download:</td>
                  <td>
                    <a href="{{ data_dump }}">
                      {{ data_dump }}
                    </a>
                  </td>
                </tr>
              {% endfor %}
              {% assign licenses = page.rdf | rdf_property: "dct:license", nil, true %}
              {% for license in licenses %}
                <tr>
                  <td>Lizenz:</td>
                  <td>
                    <a href="{{ license }}">
                      {{ license }}
                    </a>
                  </td>
                </tr>
              {% endfor %}
              {%  capture sources_query %}
                SELECT ?source
                WHERE {
                  ?resourceUri
                  prov:wasGeneratedBy/prov:used ?source ;
                } ORDER BY ?source
                {% endcapture %}
                {% assign sources = page.rdf | sparql_query: sources_query %}
                {% if sources.size > 0 %}
                  {% for row in sources %}
                    <tr>
                      <td>Quelle:</td>
                      <td>{% include core/prefix_url.html iri = row.source.iri %}</td>
                    </tr>
                  {% endfor %}
                {% endif %}
            </tbody>
          </table>
        </div>
      </div>
      <div class="row local-graph">
        <div class="col-12">
          {% include core/local_graph.html %}
        </div>
      </div>
    </div>
    {% include core/content_footer.html %}
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"></script>
  </body>
</html> #}